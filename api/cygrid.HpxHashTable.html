
<!DOCTYPE html>


<html lang="en" data-content_root="../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>HpxHashTable &#8212; cygrid v2.0.4</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/_static/cygrid.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=adc66a14"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=30646c52"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/cygrid.HpxHashTable';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ShapeError" href="cygrid.ShapeError.html" />
    <link rel="prev" title="Healpix" href="cygrid.Healpix.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="14 Apr 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">cygrid v2.0.4</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../importing_cygrid.html">
                        Importing cygrid
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../quick_tour.html">
                        Cygrid quick tour
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../user_manual.html">
                        Cygrid user manual
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-external" href="http://nbviewer.jupyter.org/github/bwinkel/cygrid/blob/master/notebooks/">
                        Tutorials (Jupyter notebooks)
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../license.html">
                        Licenses
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://github.com/bwinkel/cygrid/tree/master/notebooks">
                    Tutorials
                  </a>
                </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/bwinkel/cygrid" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../install.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../importing_cygrid.html">
                        Importing cygrid
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../quick_tour.html">
                        Cygrid quick tour
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../user_manual.html">
                        Cygrid user manual
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-external" href="http://nbviewer.jupyter.org/github/bwinkel/cygrid/blob/master/notebooks/">
                        Tutorials (Jupyter notebooks)
                      </a>
                    </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links-2">
                    More
                </button>
                <ul id="pst-nav-more-links-2" class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link dropdown-item nav-internal" href="../license.html">
                        Licenses
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://github.com/bwinkel/cygrid/tree/master/notebooks">
                    Tutorials
                  </a>
                </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/bwinkel/cygrid" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cygrid.npix_to_nside.html">npix_to_nside</a></li>
<li class="toctree-l1"><a class="reference internal" href="cygrid.nside_to_order.html">nside_to_order</a></li>
<li class="toctree-l1"><a class="reference internal" href="cygrid.produce_mock_data.html">produce_mock_data</a></li>
<li class="toctree-l1"><a class="reference internal" href="cygrid.test.html">test</a></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cygrid.Cygrid.html">Cygrid</a></li>
<li class="toctree-l1"><a class="reference internal" href="cygrid.Healpix.html">Healpix</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">HpxHashTable</a></li>
<li class="toctree-l1"><a class="reference internal" href="cygrid.ShapeError.html">ShapeError</a></li>
<li class="toctree-l1"><a class="reference internal" href="cygrid.SlGrid.html">SlGrid</a></li>
<li class="toctree-l1"><a class="reference internal" href="cygrid.WcsGrid.html">WcsGrid</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item"><nav class="sidebar-indices-items" aria-labelledby="pst-indices-navigation-heading-2">
  <p id="pst-indices-navigation-heading-2" class="sidebar-indices-items__title" role="heading" aria-level="1">Indices</p>
  <ul class="indices-link">
        <li class="toctree-l1">
          <a class="reference internal"
             href="../genindex.html"
             accesskey="I">General Index</a>
        </li>
  </ul>
</nav></div>
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../user_manual.html" class="nav-link">Cygrid user manual</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">HpxHashTable</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="hpxhashtable">
<h1>HpxHashTable<a class="headerlink" href="#hpxhashtable" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="cygrid.HpxHashTable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cygrid.</span></span><span class="sig-name descname"><span class="pre">HpxHashTable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uint64_t</span> <span class="pre">nside=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uint32_t</span> <span class="pre">scheme=RING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bool</span> <span class="pre">dbg_messages=False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="cygrid.Healpix.html#cygrid.Healpix" title="cygrid.healpix.Healpix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Healpix</span></code></a></p>
<p>Helper class for creating cygrid’s lookup tables (HEALPix).</p>
<p>This is used to speed-up cygrid, there is not really any other
meaningful application of this class. <a class="reference internal" href="#cygrid.HpxHashTable" title="cygrid.HpxHashTable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HpxHashTable</span></code></a> derives from the
<a class="reference internal" href="cygrid.Healpix.html#cygrid.Healpix" title="cygrid.Healpix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Healpix</span></code></a> class and adds-in a few helper functions and lookup-table
members.</p>
<p>Usually, only two methods have to be called: <code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_helpers</span></code> (once)
and <code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_output_pixels</span></code> (for each <a class="reference internal" href="cygrid.Cygrid.html#cygrid.Cygrid.grid" title="cygrid.Cygrid.grid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grid</span></code></a> call)
See the documentation of the methods for more information.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>nside</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unsigned</span></code> 64-bit <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The HEALPix <a class="reference internal" href="#cygrid.HpxHashTable.nside" title="cygrid.HpxHashTable.nside"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nside</span></code></a> parameter.</p>
</dd>
<dt><strong>scheme</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/enum.html#module-enum" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">enum</span></code></a></span></dt><dd><p>The HEALPix <a class="reference internal" href="#cygrid.HpxHashTable.scheme" title="cygrid.HpxHashTable.scheme"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scheme</span></code></a>. Currently, only ‘RING’ is supported.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ol class="arabic">
<li><p>The class holds a dictionary (<code class="xref py py-obj docutils literal notranslate"><span class="pre">target_dict</span></code>) that contains for each
HEALPix index the list of pixel (centers) of the target (WCS) map that
fall into this HEALPix index. For sanity a vector for the pixel centers
is used, in case multiple pixels from the WCS map have the same HPX
index. Since we need to invert the dictionary later, the coordinate
pixel pair is mapped to an integer using the very simple
transformation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xy_hash</span> <span class="o">=</span> <span class="n">xpix</span> <span class="o">*</span> <span class="n">MAX_Y</span> <span class="o">+</span> <span class="n">ypix</span>  <span class="c1"># with MAX_Y == 2**30</span>
</pre></div>
</div>
</li>
<li><p>All operations make use of the ‘RING’ scheme indexing. Therefore, we
store the HEALPix index of the first pixel in each ring, the number of
HEALPix pixels per ring and the index of the
<span class="math notranslate nohighlight">\(\varphi=180^\circ\)</span> pixel (or rather the closest pixel to the
left of <span class="math notranslate nohighlight">\(\varphi=180^\circ\)</span>, if ring is shifted).</p></li>
<li><p>Furthermore, we store for each ring the HEALPix indices of a disc (with
specified radius) as valid for <span class="math notranslate nohighlight">\(\varphi=180^\circ\)</span>. These
indices can easily be shifted along the <span class="math notranslate nohighlight">\(\varphi\)</span> coordinate to
quickly construct discs at any position.</p></li>
<li><p>For all of the above, only those indices/rings are stored that are
going to be used. Of course, if disc radius (aka kernel support
radius) is changed, the caches need to be recomputed.</p></li>
</ol>
<p class="rubric">Attributes Summary</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.ncap" title="cygrid.HpxHashTable.ncap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ncap</span></code></a></p></td>
<td><p>property ncap : unsigned 64-bit int</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.npface" title="cygrid.HpxHashTable.npface"><code class="xref py py-obj docutils literal notranslate"><span class="pre">npface</span></code></a></p></td>
<td><p>property nface : unsigned 64-bit int</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.npix" title="cygrid.HpxHashTable.npix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">npix</span></code></a></p></td>
<td><p>property npix : unsigned 64-bit int</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.nrings" title="cygrid.HpxHashTable.nrings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nrings</span></code></a></p></td>
<td><p>property nrings : unsigned 64-bit int</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.nside" title="cygrid.HpxHashTable.nside"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nside</span></code></a></p></td>
<td><p>property nside : unsigned 64-bit int</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.omega" title="cygrid.HpxHashTable.omega"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omega</span></code></a></p></td>
<td><p>property omega : double</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.order" title="cygrid.HpxHashTable.order"><code class="xref py py-obj docutils literal notranslate"><span class="pre">order</span></code></a></p></td>
<td><p>property order : unsigned 64-bit int</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.resolution" title="cygrid.HpxHashTable.resolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">resolution</span></code></a></p></td>
<td><p>property resolution : double</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.scheme" title="cygrid.HpxHashTable.scheme"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scheme</span></code></a></p></td>
<td><p>property scheme : enum</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Summary</p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.ang2pix" title="cygrid.HpxHashTable.ang2pix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ang2pix</span></code></a>(self, double theta, double phi)</p></td>
<td><p>Return the pixel index containing the angular coordinates <span class="math notranslate nohighlight">\((\varphi, \vartheta)\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.ang2pix_many" title="cygrid.HpxHashTable.ang2pix_many"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ang2pix_many</span></code></a>(self, double[, double[)</p></td>
<td><p>Return the pixel indices containing the angular coordinates of <span class="math notranslate nohighlight">\((\varphi, \vartheta)\)</span> arrays.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.clear_hashes" title="cygrid.HpxHashTable.clear_hashes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_hashes</span></code></a>(self)</p></td>
<td><p>Clear all internal caches/dictionaries.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.get_ring_info_small" title="cygrid.HpxHashTable.get_ring_info_small"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_ring_info_small</span></code></a>(self, uint64_t ring)</p></td>
<td><p>Return start index and number of pixels per healpix ring.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.pix2ang" title="cygrid.HpxHashTable.pix2ang"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pix2ang</span></code></a>(self, uint64_t pix)</p></td>
<td><p>Convert HEALPix index to angular coordinates <span class="math notranslate nohighlight">\((\varphi, \vartheta)\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.pix2ang_many" title="cygrid.HpxHashTable.pix2ang_many"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pix2ang_many</span></code></a>(self, long[)</p></td>
<td><p>Convert HEALPix indices to angular coordinates of <span class="math notranslate nohighlight">\((\varphi, \vartheta)\)</span> arrays.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.pix2ring" title="cygrid.HpxHashTable.pix2ring"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pix2ring</span></code></a>(self, uint64_t pix)</p></td>
<td><p>Return 'ring' number that contains the HEALPix pixel, 'pix'.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.pix2ring_many" title="cygrid.HpxHashTable.pix2ring_many"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pix2ring_many</span></code></a>(self, long[)</p></td>
<td><p>Return 'ring' numbers containing HEALPix pixels given in array, 'pix'.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.query_disc" title="cygrid.HpxHashTable.query_disc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">query_disc</span></code></a>(self, double theta, double phi, ...)</p></td>
<td><p>Return hpx indices of a disc around <span class="math notranslate nohighlight">\((\vartheta, \varphi)\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.query_disc_phi180" title="cygrid.HpxHashTable.query_disc_phi180"><code class="xref py py-obj docutils literal notranslate"><span class="pre">query_disc_phi180</span></code></a>(self, ...)</p></td>
<td><p>Return HEALPix indices of a disc around <span class="math notranslate nohighlight">\(\varphi=180^\circ\)</span> for 'disc_ring'.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cygrid.HpxHashTable.set_optimal_nside" title="cygrid.HpxHashTable.set_optimal_nside"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_optimal_nside</span></code></a>(self, double target_res)</p></td>
<td><p>Set the HEALPix <a class="reference internal" href="#cygrid.HpxHashTable.nside" title="cygrid.HpxHashTable.nside"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nside</span></code></a> such that HEALPix resolution is less than <code class="xref py py-obj docutils literal notranslate"><span class="pre">target_res</span></code>.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes Documentation</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.ncap">
<span class="sig-name descname"><span class="pre">ncap</span></span><a class="headerlink" href="#cygrid.HpxHashTable.ncap" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>property ncap<span class="classifier">unsigned 64-bit int</span></dt><dd><p>Return the HEALPix ‘ncap’ parameter.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.npface">
<span class="sig-name descname"><span class="pre">npface</span></span><a class="headerlink" href="#cygrid.HpxHashTable.npface" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>property nface<span class="classifier">unsigned 64-bit int</span></dt><dd><p>Return the HEALPix ‘nface’ parameter.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.npix">
<span class="sig-name descname"><span class="pre">npix</span></span><a class="headerlink" href="#cygrid.HpxHashTable.npix" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>property npix<span class="classifier">unsigned 64-bit int</span></dt><dd><p>Return the HEALPix ‘npix’ parameter.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.nrings">
<span class="sig-name descname"><span class="pre">nrings</span></span><a class="headerlink" href="#cygrid.HpxHashTable.nrings" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>property nrings<span class="classifier">unsigned 64-bit int</span></dt><dd><p>Return the HEALPix ‘nrings’ parameter.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.nside">
<span class="sig-name descname"><span class="pre">nside</span></span><a class="headerlink" href="#cygrid.HpxHashTable.nside" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>property nside<span class="classifier">unsigned 64-bit int</span></dt><dd><p>The HEALPix ‘nside’ parameter. (Re-)setting ‘nside’ updates other
properties.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.omega">
<span class="sig-name descname"><span class="pre">omega</span></span><a class="headerlink" href="#cygrid.HpxHashTable.omega" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>property omega<span class="classifier">double</span></dt><dd><p>Return the solid angle, ‘omega’ of the HEALPix pixels
for current <a class="reference internal" href="#cygrid.HpxHashTable.nside" title="cygrid.HpxHashTable.nside"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nside</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.order">
<span class="sig-name descname"><span class="pre">order</span></span><a class="headerlink" href="#cygrid.HpxHashTable.order" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>property order<span class="classifier">unsigned 64-bit int</span></dt><dd><p>Return the HEALPix ‘order’ parameter.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.resolution">
<span class="sig-name descname"><span class="pre">resolution</span></span><a class="headerlink" href="#cygrid.HpxHashTable.resolution" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>property resolution<span class="classifier">double</span></dt><dd><p>Return the angular size of the HEALPix pixels for current <a class="reference internal" href="#cygrid.HpxHashTable.nside" title="cygrid.HpxHashTable.nside"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nside</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.scheme">
<span class="sig-name descname"><span class="pre">scheme</span></span><a class="headerlink" href="#cygrid.HpxHashTable.scheme" title="Link to this definition">#</a></dt>
<dd><dl class="simple">
<dt>property scheme<span class="classifier">enum</span></dt><dd><p>The HEALPix ‘scheme’. Currently only ‘RING’ is supported.</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods Documentation</p>
<dl class="py method">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.ang2pix">
<span class="sig-name descname"><span class="pre">ang2pix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.ang2pix" title="Link to this definition">#</a></dt>
<dd><p>Return the pixel index containing the angular coordinates <span class="math notranslate nohighlight">\((\varphi, \vartheta)\)</span>.</p>
<p>Wrapper around the Cython-only (private) method _ang2pix.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>theta</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code></span></dt><dd><p><span class="math notranslate nohighlight">\(\vartheta\)</span> coordinate (<span class="math notranslate nohighlight">\(\vartheta = \pi/2 - \mathrm{latitude}\)</span>).</p>
</dd>
<dt><strong>phi</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code></span></dt><dd><p><span class="math notranslate nohighlight">\(\varphi\)</span> coordinate (longitude).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>pix</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unsigned</span></code> 64-bit <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The HEALPix pixel index.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Invalid theta value.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.ang2pix_many">
<span class="sig-name descname"><span class="pre">ang2pix_many</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double[::1]</span> <span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.ang2pix_many" title="Link to this definition">#</a></dt>
<dd><p>Return the pixel indices containing the angular coordinates of <span class="math notranslate nohighlight">\((\varphi, \vartheta)\)</span> arrays.</p>
<p>Wrapper around the Cython-only (private) method _ang2pix.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>theta</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">doubles</span></code></span></dt><dd><p><span class="math notranslate nohighlight">\(\vartheta\)</span> coordinate (<span class="math notranslate nohighlight">\(\vartheta = \pi/2 - \mathrm{latitude}\)</span>).</p>
</dd>
<dt><strong>phi</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">doubles</span></code></span></dt><dd><p><span class="math notranslate nohighlight">\(\varphi\)</span> coordinate (longitude).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>pix</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">unsigned</span></code> 64-bit <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The HEALPix pixel index.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.clear_hashes">
<span class="sig-name descname"><span class="pre">clear_hashes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.clear_hashes" title="Link to this definition">#</a></dt>
<dd><p>Clear all internal caches/dictionaries.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.get_ring_info_small">
<span class="sig-name descname"><span class="pre">get_ring_info_small</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uint64_t</span> <span class="pre">ring</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.get_ring_info_small" title="Link to this definition">#</a></dt>
<dd><p>Return start index and number of pixels per healpix ring.</p>
<p>Wrapper around the Cython-only (private) method
<code class="xref py py-obj docutils literal notranslate"><span class="pre">_get_ring_info_small</span></code>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>ring</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unsigned</span></code> 64-bit <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The HEALPix ring parameter to get information on.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>startpix</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unsigned</span></code> 64-bit <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The HEALPix index of the first pixel in ring.</p>
</dd>
<dt><strong>num_pix_in_ring</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unsigned</span></code> 64-bit <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The number of HEALPix pixels in ring.</p>
</dd>
<dt><strong>shifted</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.12)"><span class="xref std std-ref">bool</span></a></span></dt><dd><p>Whether the central HEALPix pixel in that ring is shifted from
<span class="math notranslate nohighlight">\(\varphi=180^\circ\)</span>.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Ring index not in valid range.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.pix2ang">
<span class="sig-name descname"><span class="pre">pix2ang</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uint64_t</span> <span class="pre">pix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.pix2ang" title="Link to this definition">#</a></dt>
<dd><p>Convert HEALPix index to angular coordinates <span class="math notranslate nohighlight">\((\varphi, \vartheta)\)</span>.</p>
<p>Wrapper around the Cython-only (private) method <code class="xref py py-obj docutils literal notranslate"><span class="pre">_pix2ang</span></code>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>pix</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unsigned</span></code> 64-bit <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The HEALPix pixel index.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>theta</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code></span></dt><dd><p><span class="math notranslate nohighlight">\(\vartheta\)</span> coordinate (<span class="math notranslate nohighlight">\(\vartheta = \pi/2 - \mathrm{latitude}\)</span>).</p>
</dd>
<dt><strong>phi</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code></span></dt><dd><p><span class="math notranslate nohighlight">\(\varphi\)</span> coordinate (longitude).</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pix</span></code> not in valid range.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.pix2ang_many">
<span class="sig-name descname"><span class="pre">pix2ang_many</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">long[::1]</span> <span class="pre">pix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.pix2ang_many" title="Link to this definition">#</a></dt>
<dd><p>Convert HEALPix indices to angular coordinates of <span class="math notranslate nohighlight">\((\varphi, \vartheta)\)</span> arrays.</p>
<p>Wrapper around the Cython-only (private) method <code class="xref py py-obj docutils literal notranslate"><span class="pre">_pix2ang</span></code>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>pix</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">unsigned</span></code> 64-bit <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The HEALPix pixel index.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>theta</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">doubles</span></code></span></dt><dd><p><span class="math notranslate nohighlight">\(\vartheta\)</span> coordinate (<span class="math notranslate nohighlight">\(\vartheta = \pi/2 - \mathrm{latitude}\)</span>).</p>
</dd>
<dt><strong>phi</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">doubles</span></code></span></dt><dd><p><span class="math notranslate nohighlight">\(\varphi\)</span> coordinate (longitude).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.pix2ring">
<span class="sig-name descname"><span class="pre">pix2ring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uint64_t</span> <span class="pre">pix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.pix2ring" title="Link to this definition">#</a></dt>
<dd><p>Return ‘ring’ number that contains the HEALPix pixel, ‘pix’.</p>
<p>Wrapper around the Cython-only (private) method _pix2ring.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>pix</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unsigned</span></code> 64-bit <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The HEALPix index.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>ring</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unsigned</span></code> 64-bit <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The HEALPix ring.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Pixel index not in valid range.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.pix2ring_many">
<span class="sig-name descname"><span class="pre">pix2ring_many</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">long[::1]</span> <span class="pre">pix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.pix2ring_many" title="Link to this definition">#</a></dt>
<dd><p>Return ‘ring’ numbers containing HEALPix pixels given in array, ‘pix’.</p>
<p>Wrapper around the Cython-only (private) method _pix2ring.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>pix</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">unsigned</span></code> 64-bit <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The HEALPix indices.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>ring</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">unsigned</span></code> 64-bit <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The HEALPix rings.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.query_disc">
<span class="sig-name descname"><span class="pre">query_disc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">disc_size_rad</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.query_disc" title="Link to this definition">#</a></dt>
<dd><p>Return hpx indices of a disc around <span class="math notranslate nohighlight">\((\vartheta, \varphi)\)</span>.</p>
<p>This uses <a class="reference internal" href="#cygrid.HpxHashTable.query_disc_phi180" title="cygrid.HpxHashTable.query_disc_phi180"><code class="xref py py-obj docutils literal notranslate"><span class="pre">query_disc_phi180</span></code></a> and shifts the pixels along ring.</p>
<p>Wrapper around the cython-only (private) method _query_disc.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>theta/phi</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code></span></dt><dd><p>Coordinates <span class="math notranslate nohighlight">\((\vartheta, \varphi)\)</span> in radians.</p>
</dd>
<dt><strong>disc_size_rad</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code></span></dt><dd><p>Size of the disc in radians.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>disc_indices</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">unsigned</span></code> 64-bit <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The HEALPix indices of the disc.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.query_disc_phi180">
<span class="sig-name descname"><span class="pre">query_disc_phi180</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">disc_size_rad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uint64_t</span> <span class="pre">disc_ring</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.query_disc_phi180" title="Link to this definition">#</a></dt>
<dd><p>Return HEALPix indices of a disc around <span class="math notranslate nohighlight">\(\varphi=180^\circ\)</span> for ‘disc_ring’.</p>
<p>This is a modified version of the HEALPix library <code class="xref py py-obj docutils literal notranslate"><span class="pre">query_disc</span></code>
routine that returns the HEALPix indices of a disc around arbitrary
coordinates. Here, it was modified to only work for coordinates having
<span class="math notranslate nohighlight">\(\varphi=180^\circ\)</span> and a <span class="math notranslate nohighlight">\(\vartheta\)</span> that coincides
with the latitude of a HEALPix ring. These discs can be shifted along
<span class="math notranslate nohighlight">\(\varphi\)</span> - which is faster than calling <code class="xref py py-obj docutils literal notranslate"><span class="pre">query_disc</span></code>
if one cashes the <span class="math notranslate nohighlight">\(\varphi=180^\circ\)</span> discs.</p>
<p>Wrapper around the Cython-only (private) method <code class="xref py py-obj docutils literal notranslate"><span class="pre">_query_disc_phi180</span></code>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>disc_size_rad</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code></span></dt><dd><p>Size of the disc in radians.</p>
</dd>
<dt><strong>disc_ring</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unsigned</span></code> 64-bit <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>HEALPix ring index of the requested disc center.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>disc_indices</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.26)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">unsigned</span></code> 64-bit <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The HEALPix indices of the disc.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cygrid.HpxHashTable.set_optimal_nside">
<span class="sig-name descname"><span class="pre">set_optimal_nside</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double</span> <span class="pre">target_res</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cygrid.HpxHashTable.set_optimal_nside" title="Link to this definition">#</a></dt>
<dd><p>Set the HEALPix <a class="reference internal" href="#cygrid.HpxHashTable.nside" title="cygrid.HpxHashTable.nside"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nside</span></code></a> such that HEALPix resolution is less than <code class="xref py py-obj docutils literal notranslate"><span class="pre">target_res</span></code>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>target_res</strong><span class="classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code></span></dt><dd><p>Requested target resolution of the HEALPix representation. <a class="reference internal" href="#cygrid.HpxHashTable.nside" title="cygrid.HpxHashTable.nside"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nside</span></code></a>
will be set such that the HEALPix resolution is better than
<code class="xref py py-obj docutils literal notranslate"><span class="pre">target_res</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="cygrid.Healpix.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Healpix</p>
      </div>
    </a>
    <a class="right-next"
       href="cygrid.ShapeError.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">ShapeError</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/bwinkel/cygrid/edit/master/docs/api/cygrid.HpxHashTable.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/api/cygrid.HpxHashTable.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2009–2024, Benjamin Winkel.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>